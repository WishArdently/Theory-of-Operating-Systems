## 存储管理

### 一、大容量存储器结构简介

#### 1、磁盘

转速：60-200r/s

缓存大小：8-256MB

传输速度：在驱动器和计算机之间的传输速率

定位时间（随机访问）：寻道时间+旋转等待时间



装置：盘面、磁道、扇区、柱面、转轴、读写磁头

**无交错**：步长1

**一级交错**：步长2

**二级交错**：步长3



内外密度不同——便于磁盘管理

*固态磁盘*：没有移动部件，更可靠，无寻道时间，更昂贵，寿命更短。



#### 2、磁盘结构

磁盘驱动器可以看作一个**一维的逻辑块数组**，逻辑块是最小的传输单位。（从0开始）

**映射顺序**：磁道内扇区$\rightarrow$柱面内磁道$\rightarrow$柱面顺序（从外到内）



### 二、磁盘调度

#### 1、参数

**寻道时间**：定位到柱面的时间

**旋转延迟**：定位到扇区的时间

**传输时间**：读写数据的时间

#### 2、FCFS调度

先来先服务

<img src="C:\Users\16958\AppData\Roaming\Typora\typora-user-images\image-20231224132342192.png" alt="image-20231224132342192" style="zoom:67%;" />

#### 3、SSTF调度

最短寻道时间优先

选择处理距离当前磁头位置的寻道时间最短的请求。

可能造成部分请求饥饿。

<img src="C:\Users\16958\AppData\Roaming\Typora\typora-user-images\image-20231224132549341.png" alt="image-20231224132549341" style="zoom:67%;" />

#### 4、SCAN调度

电梯算法，来回扫描

磁臂从磁盘的一端向另一端移动；

当磁头移过每一个柱面时，处理位于该柱面上的请求服务。

当到达另一端时，改变方向继续处理。

<img src="C:\Users\16958\AppData\Roaming\Typora\typora-user-images\image-20231224133055947.png" alt="image-20231224133055947" style="zoom:67%;" />

#### 5、C-SCAN调度

循环扫描调度

SCAN的一个变种，磁臂从磁盘的一端向另一端移动，当磁头移过每一个柱面时，处理位于该柱面上的请求服务；

当到达另一端时$\color{red}{立即返回磁盘的开头}$。

<img src="C:\Users\16958\AppData\Roaming\Typora\typora-user-images\image-20231224133350259.png" alt="image-20231224133350259" style="zoom:67%;" />

#### 6、LOOK/C-LOOK调度

磁臂只要移动到一个方向的最远请求为止。

<img src="C:\Users\16958\AppData\Roaming\Typora\typora-user-images\image-20231224133639653.png" alt="image-20231224133639653" style="zoom:67%;" />

#### 7、磁盘调度算法的选择

SSTF的性能较好，但是易造成请求饥饿。

磁盘负荷大的系统，SCAN和CSCAN更好

SSTF和LOOK是比较合理的默认算法选择。

### 三、磁盘格式化

#### 1、低级格式化

将原始磁盘划分扇区的过程。

每个扇区分为：头部+数据区域+尾部

头尾用于控制，如EEC纠错代码。

数据区域通常是512B



正式存储数据之前：
**划分分区**：由磁盘柱面组成

**逻辑格式化**：创建操作系统

#### 2、引导块

从磁盘第一个扇区调入主引导记录（MBR）到内存，MBR包括引导代码，磁盘分区表，引导分区标记。

找到引导分区，读取其第一扇区（引导扇区），

加载系统组件。

### 四、RAID

#### 1、概念

RAID，廉价磁盘冗余阵列。

多个独立的物理硬盘按照不同的方式组合起来，形成一个虚拟的硬盘。

#### 2、优势

**（1）容量和管理**

易于进行灵活的容量扩展。

“虚拟化”使可管理性极大的增强。

**（2）性能**

“磁盘分块”（条带化）技术带来性能的提高。

**（3）可靠性和可用性**

通过冗余技术和热换提升了可靠性

#### 3、镜像冗余

镜像冗余使用了**磁盘镜像**技术

每个I/O操作都会在两个磁盘上执行，两个磁盘看起来就像是一个磁盘一样。

优点：提高磁盘的读性能。

#### 4、校验冗余

根据冗余算法计算阵列中的成员磁盘上数据的校验信息，将校验信息**保存在其他的磁盘资源上**，保证数据可靠性。

优点：开销更小

#### 5、RAID级别

RAID0：数据损失并不重要的程序

RAID1：高可靠性和快速恢复的程序

RAID0 + 1（RAID1 + 0）：性能和可靠性都重要的程序

RAID5：性能、数据安全和存储成本兼顾，存储大量数据首选。

